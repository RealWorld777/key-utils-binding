#include <iostream>
#include "K12AndKeyUtil.h"

int main() {
    // tx: bba07fde537ea438760811910f2d874f017974eadcfdde70aa771533aa94064cf219230a0b56fbb94b3d73d3879f245390fccc3b23c1fdab0482f59b14a9fe16000000000000000100abfa9a00000000
    unsigned char tx[80] = {
        0xbb, 0xa0, 0x7f, 0xde, 0x53, 0x7e, 0xa4, 0x38,
        0x76, 0x08, 0x11, 0x91, 0x0f, 0x2d, 0x87, 0x4f,
        0x01, 0x79, 0x74, 0xea, 0xdc, 0xfd, 0xde, 0x70,
        0xaa, 0x77, 0x15, 0x33, 0xaa, 0x94, 0x06, 0x4c,
        0xf2, 0x19, 0x23, 0x0a, 0x0b, 0x56, 0xfb, 0xb9,
        0x4b, 0x3d, 0x73, 0xd3, 0x87, 0x9f, 0x24, 0x53,
        0x90, 0xfc, 0xcc, 0x3b, 0x23, 0xc1, 0xfd, 0xab,
        0x04, 0x82, 0xf5, 0x9b, 0x14, 0xa9, 0xfe, 0x16,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
        0xab, 0xfa, 0x9a, 0x00, 0x00, 0x00, 0x00, 0x00
    };
    unsigned char messageDigest[32] = {0};

    KangarooTwelve((unsigned char*)tx, 80, messageDigest, 32);

    std::cout << "messageDigest: ";
    for (int i = 0; i < 32; i++) {
        printf("%02x", messageDigest[i]);
    }
    std::cout << std::endl;
    return 0;
}